---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import BlogPostCard from '../components/BlogPostCard.astro';

const recentPosts = (await getCollection('posts', ({ data }) => {
  return data.draft !== true;
}))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 6);
---

<BaseLayout
  title="Home - Personal Blog"
  description="A blog about web development, performance, and modern web technologies"
>
  <Header />

  <main id="main-content" class="flex-1" role="main">
    <!-- Hero Section -->
    <section class="border-b bg-secondary/30">
      <div class="container mx-auto px-4 py-16 md:py-24 text-center">
        <h1 class="text-4xl md:text-6xl font-bold mb-6">
          Welcome to My Blog
        </h1>
        <p class="text-xl text-muted-foreground max-w-2xl mx-auto mb-8">
          Exploring web development, performance optimization, and building fast, accessible websites
        </p>
        <a
          href="/blog/blog/"
          class="inline-flex items-center justify-center rounded-md bg-primary px-6 py-3 text-primary-foreground hover:bg-primary/90 transition-colors font-medium"
        >
          Read the Blog
        </a>
      </div>
    </section>

    <!-- Recent Posts -->
    <section class="container mx-auto px-4 py-12">
      <div class="flex items-center justify-between mb-8">
        <h2 class="text-3xl font-bold">Recent Posts</h2>
        <a
          href="/blog/blog/"
          class="text-sm hover:text-primary transition-colors"
        >
          View all â†’
        </a>
      </div>

      <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        {recentPosts.map((post) => (
          <BlogPostCard
            title={post.data.title}
            description={post.data.description}
            pubDate={post.data.pubDate}
            slug={post.slug}
            tags={post.data.tags}
            heroImage={post.data.heroImage}
          />
        ))}
      </div>

      {recentPosts.length === 0 && (
        <p class="text-center text-muted-foreground py-12">
          No blog posts yet. Check back soon!
        </p>
      )}
    </section>
  </main>

  <Footer />
</BaseLayout>
