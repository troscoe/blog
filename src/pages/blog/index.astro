---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import BlogPostCard from '../../components/BlogPostCard.astro';

const posts = (await getCollection('posts', ({ data }) => {
  return data.draft !== true;
})).sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<BaseLayout
  title="Blog"
  description="Articles about web development, performance, and modern web technologies"
>
  <Header />

  <main class="flex-1">
    <div class="container mx-auto px-4 py-12">
      <h1 class="text-4xl font-bold mb-8">Blog</h1>

      <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        {posts.map((post) => (
          <BlogPostCard
            title={post.data.title}
            description={post.data.description}
            pubDate={post.data.pubDate}
            slug={post.slug}
            tags={post.data.tags}
            heroImage={post.data.heroImage}
          />
        ))}
      </div>

      {posts.length === 0 && (
        <p class="text-center text-muted-foreground py-12">
          No blog posts yet. Check back soon!
        </p>
      )}
    </div>
  </main>

  <Footer />
</BaseLayout>
